name: PR checkers B
on:
  pull_request:
    paths:
      - 'serviceB/**'
      - .github/workflows/serviceB-pr.yml

jobs:
  unit-tests:
    runs-on: ubuntu-latest
    container:
      image: docker
      volumes:
       - /var/run/docker.sock:/var/run/docker.sock
    steps:
      - name: load/create cache for make tasks
        uses: actions/cache@v2
        with:
          path: out/**
          key: ${{ runner.os }}-build-${{ github.sha }}
      - name: Check out repository code
        uses: actions/checkout@v2
      - run: apk add make
      - run: make check_files_on_out
      - run: make integration-test1
      - run: make write_on_out
      - run: make integration-test2
      - run: make check_files_on_out

